const { expect, assert } = require("chai");
const hre = require("hardhat");

describe("SBT minting and verification", function () {

  let privateSoulMinter;
  let verifier;
  let privateOver18Aidrop;

  beforeEach(async function () {
    signers = await hre.ethers.getSigners();
    collector = signers[1];
    collectorAddress = collector.address;

    // Deploy Private Soul Minter contract
    let PrivateSoulMinterContract = await hre.ethers.getContractFactory("PrivateSoulMinter")
    privateSoulMinter = await PrivateSoulMinterContract.deploy()

    // Deploy Verifier contract
    let VerifierContract = await hre.ethers.getContractFactory("Verifier")
    verifier = await VerifierContract.deploy()

    // Deploy Private Over 18 Airdrop contract
    let PrivateOver18AirdropContract = await hre.ethers.getContractFactory("PrivateOver18Airdrop")
    privateOver18Aidrop = await PrivateOver18AirdropContract.deploy(verifier.address, privateSoulMinter.address)

    // input correct claim signature by the issuer
    let sigR8x = "5288934873515066744407360021175347774328283521815243825463338156746700965443"
    let sigR8y = "4653388640217130471849235597911239222005917737883282265350750838939007616127"
    let sigS  = "339273884829908499315499470612334526171037569413339691177061986410380854479"    

    // mint the NFT to the collector
    metaURI = "https://bafybeibodo3cnumo76lzdf2dlatuoxtxahgowxuihwiqeyka7k2qt7eupy.ipfs.nftstorage.link/"
    claimHashMetadata = hre.ethers.utils.solidityKeccak256(["uint", "uint", "uint"], [sigR8x, sigR8y, sigS])

    let tx = await privateSoulMinter.mint(collectorAddress, metaURI,claimHashMetadata);

    let receipt = await tx.wait();
    tokenId = receipt.events?.filter((x) => {return x.event == "Transfer"})[0].topics[3]
  });

  it("the SBT should not be transferable", async function () {
    await expect(privateSoulMinter.connect(collector).transferFrom(collectorAddress, signers[2].address, tokenId)).to.be.reverted;
  });

  it("shouldn't allow accounts that are not contract owner to mint SBTs", async function () {
    await expect(privateSoulMinter.mint(collectorAddress, metaURI, claimHashMetadata)).to.be.revertedWith("You can only have one token associated to your soul");
  });

  it("a user cannot have more than 1 SBT attesting their age", async function () {
    await expect(privateSoulMinter.connect(collector).mint(collectorAddress, metaURI, claimHashMetadata)).to.be.revertedWith("Ownable: caller is not the owner");
  });

  it("should include the user in the aidrop after presenting a correct proof", async function () {

    // A[2] B[[2][2]] C[2] represent the proof
    let a = ["0x0a2be014eb4d0c92d05d58d8200e5217af68b5f626ca2a0569585ee88bf01235", "0x13bb2962d38bb586618020460217fa1092923597d18e3aa7b226d7704c044217"]
    let b = [["0x03eeb41ef167f0ad6aeb8abb2357f5e02284d132d320baf45064b05089366d96", "0x2595eb07e7abe9d9694bc42ccca054f2e3cdeb9a90ff4e179591adf55db6995c"],["0x16862d91527c0740ad2b8d71634105b4b8ddbb0d67fe33dfe5492e9862e3c13f", "0x00276e1d1be4397b73217c5e75081c6455558f7f5599ea6e8dabda3b949b7b7d"]]
    let c = ["0x0163849d0a0bc1979c6193dcaeeefa7c80b5ccb008c21ae9296f1d3f4eca874a", "0x285e3138fc3a1ae628bc44e5540b1301743f8c995d6757a48a9b4aee9fbca971"]
    // input[72] represents the public input of the circuit
    let input = ["0x0bb16e59a25fb48b6b644fd1f98e022ab0938a33c9fffd8d11792e1bd7ff4643","0x0a49b981a887e4a7f69268120a574137424a46a5f3d40a1a3069a3d7936c847f","0x00c005afcdc4fe33f89f6d822a96f53151a630373803cdcb2ec0c15734ab04cf","0x152f5044240ef872cf7e6742fe202b9e07ed6188e9e734c09b06939704852358","0x2865441cd3e276643c84e55004ad259dff282c8c47c6e8c151afacdadf6f6db3","0x0000000000000000000000000000000087b9b4c689c2024c54d1bf962cb16bce","0x0000000000000000000000000000000000000000000000000000000000000002","0x0000000000000000000000000000000000000000000000000000000000000003","0x0000000000000000000000000000000000000000000000000000000000000012","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000"]
    await privateOver18Aidrop.connect(collector).collectAirdrop(a, b, c, input, tokenId);

    assert.equal(await privateOver18Aidrop.isElegibleForAirdrop(collectorAddress), true);

  });


  it("should revert if a user presents the same proof twice", async function () {
    
    // A[2] B[[2][2]] C[2] represent the proof
    let a = ["0x0a2be014eb4d0c92d05d58d8200e5217af68b5f626ca2a0569585ee88bf01235", "0x13bb2962d38bb586618020460217fa1092923597d18e3aa7b226d7704c044217"]
    let b = [["0x03eeb41ef167f0ad6aeb8abb2357f5e02284d132d320baf45064b05089366d96", "0x2595eb07e7abe9d9694bc42ccca054f2e3cdeb9a90ff4e179591adf55db6995c"],["0x16862d91527c0740ad2b8d71634105b4b8ddbb0d67fe33dfe5492e9862e3c13f", "0x00276e1d1be4397b73217c5e75081c6455558f7f5599ea6e8dabda3b949b7b7d"]]
    let c = ["0x0163849d0a0bc1979c6193dcaeeefa7c80b5ccb008c21ae9296f1d3f4eca874a", "0x285e3138fc3a1ae628bc44e5540b1301743f8c995d6757a48a9b4aee9fbca971"]
    // input[72] represents the public input of the circuit
    let input = ["0x0bb16e59a25fb48b6b644fd1f98e022ab0938a33c9fffd8d11792e1bd7ff4643","0x0a49b981a887e4a7f69268120a574137424a46a5f3d40a1a3069a3d7936c847f","0x00c005afcdc4fe33f89f6d822a96f53151a630373803cdcb2ec0c15734ab04cf","0x152f5044240ef872cf7e6742fe202b9e07ed6188e9e734c09b06939704852358","0x2865441cd3e276643c84e55004ad259dff282c8c47c6e8c151afacdadf6f6db3","0x0000000000000000000000000000000087b9b4c689c2024c54d1bf962cb16bce","0x0000000000000000000000000000000000000000000000000000000000000002","0x0000000000000000000000000000000000000000000000000000000000000003","0x0000000000000000000000000000000000000000000000000000000000000012","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000"]
    await privateOver18Aidrop.connect(collector).collectAirdrop(a, b, c, input, tokenId);

    await expect(privateOver18Aidrop.connect(collector).collectAirdrop(a, b, c, input, tokenId)).to.be.revertedWith("You already claimed your airdrop!");
  });

  it("should revert if the correct proof is presented by someone who is not the owner of the SBT", async function () {

    // A[2] B[[2][2]] C[2] represent the proof
    let a = ["0x0a2be014eb4d0c92d05d58d8200e5217af68b5f626ca2a0569585ee88bf01235", "0x13bb2962d38bb586618020460217fa1092923597d18e3aa7b226d7704c044217"]
    let b = [["0x03eeb41ef167f0ad6aeb8abb2357f5e02284d132d320baf45064b05089366d96", "0x2595eb07e7abe9d9694bc42ccca054f2e3cdeb9a90ff4e179591adf55db6995c"],["0x16862d91527c0740ad2b8d71634105b4b8ddbb0d67fe33dfe5492e9862e3c13f", "0x00276e1d1be4397b73217c5e75081c6455558f7f5599ea6e8dabda3b949b7b7d"]]
    let c = ["0x0163849d0a0bc1979c6193dcaeeefa7c80b5ccb008c21ae9296f1d3f4eca874a", "0x285e3138fc3a1ae628bc44e5540b1301743f8c995d6757a48a9b4aee9fbca971"]
    // input[72] represents the public input of the circuit
    let input = ["0x0bb16e59a25fb48b6b644fd1f98e022ab0938a33c9fffd8d11792e1bd7ff4643","0x0a49b981a887e4a7f69268120a574137424a46a5f3d40a1a3069a3d7936c847f","0x00c005afcdc4fe33f89f6d822a96f53151a630373803cdcb2ec0c15734ab04cf","0x152f5044240ef872cf7e6742fe202b9e07ed6188e9e734c09b06939704852358","0x2865441cd3e276643c84e55004ad259dff282c8c47c6e8c151afacdadf6f6db3","0x0000000000000000000000000000000087b9b4c689c2024c54d1bf962cb16bce","0x0000000000000000000000000000000000000000000000000000000000000002","0x0000000000000000000000000000000000000000000000000000000000000003","0x0000000000000000000000000000000000000000000000000000000000000012","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000"]
    await expect(privateOver18Aidrop.connect(signers[2]).collectAirdrop(a, b, c, input, tokenId)).to.be.revertedWith("This token belongs to another soul");
  });

  it("should revert if presented a proof based on an invalid schema", async function () {

    // A[2] B[[2][2]] C[2] represent the proof
    let a = ["0x0a2be014eb4d0c92d05d58d8200e5217af68b5f626ca2a0569585ee88bf01235", "0x13bb2962d38bb586618020460217fa1092923597d18e3aa7b226d7704c044217"]
    let b = [["0x03eeb41ef167f0ad6aeb8abb2357f5e02284d132d320baf45064b05089366d96", "0x2595eb07e7abe9d9694bc42ccca054f2e3cdeb9a90ff4e179591adf55db6995c"],["0x16862d91527c0740ad2b8d71634105b4b8ddbb0d67fe33dfe5492e9862e3c13f", "0x00276e1d1be4397b73217c5e75081c6455558f7f5599ea6e8dabda3b949b7b7d"]]
    let c = ["0x0163849d0a0bc1979c6193dcaeeefa7c80b5ccb008c21ae9296f1d3f4eca874a", "0x285e3138fc3a1ae628bc44e5540b1301743f8c995d6757a48a9b4aee9fbca971"]
    // input[72] represents the public input of the circuit
    let input = ["0x0bb16e59a25fb48b6b644fd1f98e022ab0938a33c9fffd8d11792e1bd7ff4643","0x0a49b981a887e4a7f69268120a574137424a46a5f3d40a1a3069a3d7936c847f","0x00c005afcdc4fe33f89f6d822a96f53151a630373803cdcb2ec0c15734ab04cf","0x152f5044240ef872cf7e6742fe202b9e07ed6188e9e734c09b06939704852358","0x2865441cd3e276643c84e55004ad259dff282c8c47c6e8c151afacdadf6f6db3","0x0000000000000000000000000000000087b9b4c689c2024c54d1bf962cb16bce","0x0000000000000000000000000000000000000000000000000000000000000002","0x0000000000000000000000000000000000000000000000000000000000000003","0x0000000000000000000000000000000000000000000000000000000000000012","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000"]

    let invalidSchemaHash = "0x0000000000000000000000000000000087b9b4c689c2024c54d1bf962cb16bcd"

    input[5] = invalidSchemaHash

    await expect(privateOver18Aidrop.connect(collector).collectAirdrop(a, b, c, input, tokenId)).to.be.revertedWith("Wrong Claim schema used to generate the proof");
  });

  it("should revert if presented a proof based on a different query #1 ", async function () {

    // A[2] B[[2][2]] C[2] represent the proof
    let a = ["0x0a2be014eb4d0c92d05d58d8200e5217af68b5f626ca2a0569585ee88bf01235", "0x13bb2962d38bb586618020460217fa1092923597d18e3aa7b226d7704c044217"]
    let b = [["0x03eeb41ef167f0ad6aeb8abb2357f5e02284d132d320baf45064b05089366d96", "0x2595eb07e7abe9d9694bc42ccca054f2e3cdeb9a90ff4e179591adf55db6995c"],["0x16862d91527c0740ad2b8d71634105b4b8ddbb0d67fe33dfe5492e9862e3c13f", "0x00276e1d1be4397b73217c5e75081c6455558f7f5599ea6e8dabda3b949b7b7d"]]
    let c = ["0x0163849d0a0bc1979c6193dcaeeefa7c80b5ccb008c21ae9296f1d3f4eca874a", "0x285e3138fc3a1ae628bc44e5540b1301743f8c995d6757a48a9b4aee9fbca971"]
    // input[72] represents the public input of the circuit
    let input = ["0x0bb16e59a25fb48b6b644fd1f98e022ab0938a33c9fffd8d11792e1bd7ff4643","0x0a49b981a887e4a7f69268120a574137424a46a5f3d40a1a3069a3d7936c847f","0x00c005afcdc4fe33f89f6d822a96f53151a630373803cdcb2ec0c15734ab04cf","0x152f5044240ef872cf7e6742fe202b9e07ed6188e9e734c09b06939704852358","0x2865441cd3e276643c84e55004ad259dff282c8c47c6e8c151afacdadf6f6db3","0x0000000000000000000000000000000087b9b4c689c2024c54d1bf962cb16bce","0x0000000000000000000000000000000000000000000000000000000000000002","0x0000000000000000000000000000000000000000000000000000000000000003","0x0000000000000000000000000000000000000000000000000000000000000012","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000"]
    
    // Using a query based on a slot index 3 instead of slot index 2
    let invalidQuerySlot = "0x0000000000000000000000000000000000000000000000000000000000000003"

    input[6] = invalidQuerySlot

    await expect(privateOver18Aidrop.connect(collector).collectAirdrop(a, b, c, input, tokenId)).to.be.revertedWith("Invalid slot index used to generate the proof");
  });

  it("should revert if presented a proof based on a different query #2 ", async function () {
    
    let a = ["0x0a2be014eb4d0c92d05d58d8200e5217af68b5f626ca2a0569585ee88bf01235", "0x13bb2962d38bb586618020460217fa1092923597d18e3aa7b226d7704c044217"]
    let b = [["0x03eeb41ef167f0ad6aeb8abb2357f5e02284d132d320baf45064b05089366d96", "0x2595eb07e7abe9d9694bc42ccca054f2e3cdeb9a90ff4e179591adf55db6995c"],["0x16862d91527c0740ad2b8d71634105b4b8ddbb0d67fe33dfe5492e9862e3c13f", "0x00276e1d1be4397b73217c5e75081c6455558f7f5599ea6e8dabda3b949b7b7d"]]
    let c = ["0x0163849d0a0bc1979c6193dcaeeefa7c80b5ccb008c21ae9296f1d3f4eca874a", "0x285e3138fc3a1ae628bc44e5540b1301743f8c995d6757a48a9b4aee9fbca971"]
    // input[72] represents the public input of the circuit
    let input = ["0x0bb16e59a25fb48b6b644fd1f98e022ab0938a33c9fffd8d11792e1bd7ff4643","0x0a49b981a887e4a7f69268120a574137424a46a5f3d40a1a3069a3d7936c847f","0x00c005afcdc4fe33f89f6d822a96f53151a630373803cdcb2ec0c15734ab04cf","0x152f5044240ef872cf7e6742fe202b9e07ed6188e9e734c09b06939704852358","0x2865441cd3e276643c84e55004ad259dff282c8c47c6e8c151afacdadf6f6db3","0x0000000000000000000000000000000087b9b4c689c2024c54d1bf962cb16bce","0x0000000000000000000000000000000000000000000000000000000000000002","0x0000000000000000000000000000000000000000000000000000000000000003","0x0000000000000000000000000000000000000000000000000000000000000012","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000"]
    // Using a query based on a operator 3 (greater than) we use operator 2 (less than)
    let invalidQueryOperator = "0x0000000000000000000000000000000000000000000000000000000000000002"

    input[7] = invalidQueryOperator
    await expect(privateOver18Aidrop.connect(collector).collectAirdrop(a, b, c, input, tokenId)).to.be.revertedWith("Invalid operator used to generate the proof");
  });

  it("should revert if a user passes in a wrong signature", async function () {

    let a = ["0x0a2be014eb4d0c92d05d58d8200e5217af68b5f626ca2a0569585ee88bf01235", "0x13bb2962d38bb586618020460217fa1092923597d18e3aa7b226d7704c044217"]
    let b = [["0x03eeb41ef167f0ad6aeb8abb2357f5e02284d132d320baf45064b05089366d96", "0x2595eb07e7abe9d9694bc42ccca054f2e3cdeb9a90ff4e179591adf55db6995c"],["0x16862d91527c0740ad2b8d71634105b4b8ddbb0d67fe33dfe5492e9862e3c13f", "0x00276e1d1be4397b73217c5e75081c6455558f7f5599ea6e8dabda3b949b7b7d"]]
    let c = ["0x0163849d0a0bc1979c6193dcaeeefa7c80b5ccb008c21ae9296f1d3f4eca874a", "0x285e3138fc3a1ae628bc44e5540b1301743f8c995d6757a48a9b4aee9fbca971"]
    // input[72] represents the public input of the circuit
    let input = ["0x0bb16e59a25fb48b6b644fd1f98e022ab0938a33c9fffd8d11792e1bd7ff4643","0x0a49b981a887e4a7f69268120a574137424a46a5f3d40a1a3069a3d7936c847f","0x00c005afcdc4fe33f89f6d822a96f53151a630373803cdcb2ec0c15734ab04cf","0x152f5044240ef872cf7e6742fe202b9e07ed6188e9e734c09b06939704852358","0x2865441cd3e276643c84e55004ad259dff282c8c47c6e8c151afacdadf6f6db3","0x0000000000000000000000000000000087b9b4c689c2024c54d1bf962cb16bce","0x0000000000000000000000000000000000000000000000000000000000000002","0x0000000000000000000000000000000000000000000000000000000000000003","0x0000000000000000000000000000000000000000000000000000000000000012","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000"]

    // Use an invalid claim signature    
    let invalidClaimSignature = "0x153f5044240ef872cf7e6742fe202b9e07ed6188e9e734c09b06939704852354"

    input[2] = invalidClaimSignature

    await expect(privateOver18Aidrop.connect(collector).collectAirdrop(a, b, c, input, tokenId)).to.be.revertedWith("The signature is not valid");
  });

  it("should revert if passing a wrong proof", async function () {

    let a = ["0x0a2be014eb4d0c92d05d58d8200e5217af68b5f626ca2a0569585ee88bf01235", "0x13bb2962d38bb586618020460217fa1092923597d18e3aa7b226d7704c044217"]
    let b = [["0x03eeb41ef167f0ad6aeb8abb2357f5e02284d132d320baf45064b05089366d96", "0x2595eb07e7abe9d9694bc42ccca054f2e3cdeb9a90ff4e179591adf55db6995c"],["0x16862d91527c0740ad2b8d71634105b4b8ddbb0d67fe33dfe5492e9862e3c13f", "0x00276e1d1be4397b73217c5e75081c6455558f7f5599ea6e8dabda3b949b7b7d"]]
    let c = ["0x0163849d0a0bc1979c6193dcaeeefa7c80b5ccb008c21ae9296f1d3f4eca874a", "0x285e3138fc3a1ae628bc44e5540b1301743f8c995d6757a48a9b4aee9fbca971"]
    // input[72] represents the public input of the circuit
    let input = ["0x0bb16e59a25fb48b6b644fd1f98e022ab0938a33c9fffd8d11792e1bd7ff4643","0x0a49b981a887e4a7f69268120a574137424a46a5f3d40a1a3069a3d7936c847f","0x00c005afcdc4fe33f89f6d822a96f53151a630373803cdcb2ec0c15734ab04cf","0x152f5044240ef872cf7e6742fe202b9e07ed6188e9e734c09b06939704852358","0x2865441cd3e276643c84e55004ad259dff282c8c47c6e8c151afacdadf6f6db3","0x0000000000000000000000000000000087b9b4c689c2024c54d1bf962cb16bce","0x0000000000000000000000000000000000000000000000000000000000000002","0x0000000000000000000000000000000000000000000000000000000000000003","0x0000000000000000000000000000000000000000000000000000000000000012","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000","0x0000000000000000000000000000000000000000000000000000000000000000"]

    // use an invalid proof
    let invalidAProofPoint = "0x2f663616e413bb4bbd6ed9afa70ae0e1be2190fd35fba3af817bbebad369970c"

    a[0] = invalidAProofPoint

    await expect(privateOver18Aidrop.connect(collector).collectAirdrop(a, b, c, input, tokenId)).to.be.reverted
  });
});